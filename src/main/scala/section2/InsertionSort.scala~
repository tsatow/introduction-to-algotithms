package section2

object InsertionSort {
  /** 引数の配列を変更し、ソートする。配列外に記憶される要素は高々定数個となる。
    * 
    */
  def apply[T](array: Array[T])(implicit o: Ordering[T]): Array[T] = {
    for (j <- 1 to array.length) {
      val key = array(j)
      var i = j - 1

      // j番目の要素より前の要素の方が小さければそれらを後方にずらしてj番目の要素を挿入する
      while (i >= 0 && o.gt(array(i), key)) {
        array(i + 1) = array(i)
        i = i - 1
      }
      array(i + 1) = key
    }
    array
  }
}
